"use strict";!function(){var e,c,u,n,i,a,_,t,o,h,v,r;e=window.wp,c=jQuery,e&&e.customize&&(u=e.customize,_=wc_voucher_template_preview,t=function(){var e=u("wc_voucher_template_voucher_primary_image").get(),o=c("#voucher-image img");return e.width!==o.width()?_.image_scale=o.width()/e.width:_.image_scale=1,v("voucher",a(u("wc_voucher_template_voucher_font_size").get())),c.each(_.voucher_fields,function(e,t){var i,r,n=c("#voucher #"+t);return""!==o.attr("src")&&(r=(r=u("wc_voucher_template_"+t+"_pos").get())?r.split(",").map(function(e){return parseInt(e,10)*_.image_scale}):null)?(i={left:r[0]+"px",top:r[1]+"px",width:r[2]+"px",height:r[3]+"px"},n.css(i).show(),r=null,(r=(i=u("wc_voucher_template_"+t+"_font_size"))?i.get():r)?v(t,a(r)):void 0):n.hide()})},a=function(e){return e*(u("wc_voucher_template_voucher_image_dpi").get()/72*_.image_scale)},v=function(e,t){var i=_.css_config.font_size;return h(e,i,t)},h=function(e,t,i){i=i?t.value.replace("{$value}",i):"";return c("#"+e).css(t.property,i)},o=function(){return c("#voucher-image img").imgAreaSelect({remove:!0}),t()},r=function(i){var e,t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(c("#voucher-image img").attr("src"))return o(),c("#voucher #"+i).hide(),t=u("wc_voucher_template_"+i+"_pos").get(),e=u("wc_voucher_template_voucher_primary_image").get(),t=t?t.split(",").map(function(e){return parseInt(e,10)}):[null,null,null,null],c("#voucher-image img").imgAreaSelect({show:!0,handles:!0,instance:!0,imageWidth:e.width,imageHeight:e.height,x1:t[0],y1:t[1],x2:t[0]+t[2],y2:t[1]+t[3],aspectRatio:r,onSelectEnd:function(e,t){n(t,i)}})},n=function(e,t){e=[e.x1,e.y1,e.width,e.height];return u.preview.send("voucher:update-position:"+t,e.join(","))},i=function(n){if(_.css_config)return c.each(_.css_config,function(t,i){var r;if(i.property)return i.value||(i.value="{$value}"),r=function(e){return"font_size"===t&&(e=(e="0"===e?null:e)&&a(e)),h(n,i,e)},u("wc_voucher_template_"+n+"_"+t,function(e){return r(e.get()),e.bind(r)})})},u("wc_voucher_template_voucher_primary_image",function(e){return e.bind(function(e){return c("#voucher-image img").prop("src",e.src).load(function(){return e.src?c("body").removeClass("voucher-no-image"):c("body").addClass("voucher-no-image"),t()})})}),u("wc_voucher_template_voucher_additional_image",function(e){return e.bind(function(e){return c("#voucher-additional-image img").prop("src",e)})}),u("wc_voucher_template_voucher_image_dpi",function(e){return e.bind(t)}),c(function(){return u.preview.bind("voucher:start-positioning",function(e){return r(e.field_id,e.aspect_ratio)}),u.preview.bind("voucher:stop-positioning",function(e){return o()}),u.preview.bind("voucher:remove-position",function(e){return t()}),u.preview.bind("voucher:update-position",function(e){return console.log("update...",e),t()}),c(window).resize(t),setTimeout(function(){return t(),i("voucher"),c.each(_.voucher_fields,function(e,t){return i(t)})},0),c("#voucher").click(".js-voucher-field-pos",function(e){return u.preview.send("voucher:click-position:"+e.target.id)})}))}.call(void 0);
//# sourceMappingURL=wc-pdf-product-vouchers-customizer-preview.min.js.map
